<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ace="http://www.icefaces.org/icefaces/components">
    <h:head>
        <title>All routes</title>
    </h:head>
    <h:body>
        <f:view> 
            <tr> 
            </tr> 
            <h:form> 
                <h2> 
                    <h:outputLabel value="Routes"/> 
                </h2> 
                <ace:dataTable value="#{routeBean.getAllRoutes()}"
                               var="rt"
                               stateMap="#{routeBean.stateMap}"  
                               selectionMode="single">
                    <ace:column headerText="Id" sortBy="#{rt.idRoute} "
                                rendered ="false" filterBy="#{rt.idRoute}" filterMatchMode="contains">
                        <h:outputText value="#{rt.idRoute}"/>
                    </ace:column>
                    <ace:column headerText="Number" sortBy="#{rt.number}"
                                filterBy="#{rt.number}" filterMatchMode="contains">
                        <h:outputText value="#{rt.number}"/>
                    </ace:column>
                    <ace:column headerText="First stop" sortBy="#{rt.firstStop.name}"
                                filterBy="#{rt.firstStop.name}" filterMatchMode="contains">
                        <h:outputText value="#{rt.firstStop.name}"/>
                    </ace:column>
                    <ace:column headerText="Last stop" sortBy="#{rt.lastStop.name}"
                                filterBy="#{rt.lastStop.name}" filterMatchMode="contains">
                        <h:outputText value="#{rt.lastStop.name}"/>
                    </ace:column>
                    <ace:column headerText="Rating" sortBy="#{rt.rating} "
                                rendered ="true" filterBy="#{rt.rating}" filterMatchMode="contains">
                        <h:outputText value="#{rt.rating}"/>
                    </ace:column>
                    <ace:column headerText="Ticket price" sortBy="#{rt.price} "
                                rendered ="true" filterBy="#{rt.price}" filterMatchMode="contains">
                        <h:outputText value="#{rt.price}"/>
                    </ace:column>
                    <ace:column headerText="">
                        <h:commandLink action="#{routeBean.redirectRouteInfo(rt.idRoute)}" value="Route info"/>
                    </ace:column>
                </ace:dataTable>
                <br/><br/>
                <h:commandButton value="Check stops" action="/allStops.xhtml"/>
                <br/><br/>
                <h:commandButton value="Add route" rendered="#{request.isUserInRole('admin')}"  action="/addRoute.xhtml"/> 
                <br/><br/>
                <h:commandButton value="Delete route"  rendered="#{request.isUserInRole('admin')}" actionListener="#{routeBean.actionListener}"/> 
            </h:form> 
        </f:view>
    </h:body>
</html>


